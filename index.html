<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dozen Pair Pattern Engine</title>
    <style>
        :root {
            --bg: #0b0f19;
            --card: #161e2d;
            --primary: #00d2ff;
            --accent: #00ff88;
            --danger: #ff0055;
            --text: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; }

        header { text-align: center; margin-bottom: 25px; }
        h1 { font-size: 1.5rem; color: var(--primary); letter-spacing: 1.5px; }

        /* Prediction Dashboard */
        .prediction-card {
            background: var(--card);
            border: 2px solid #2d3748;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }

        .status-header {
            font-size: 0.75rem;
            font-weight: 800;
            letter-spacing: 2px;
            margin-bottom: 15px;
            color: #718096;
            text-transform: uppercase;
        }

        .status-header.active { color: var(--accent); }

        .dozen-pair-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .dozen-box {
            width: 100px;
            height: 100px;
            background: #0b0f19;
            border: 3px solid #2d3748;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .dozen-box.hit {
            border-color: var(--primary);
            background: rgba(0, 210, 255, 0.1);
            transform: scale(1.05);
        }

        .dozen-box .num-val { font-size: 3rem; font-weight: 900; }
        .dozen-box .label { font-size: 0.6rem; color: #4a5568; margin-top: -5px; }

        .seq-tag {
            background: rgba(0,0,0,0.3);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 0.8rem;
            color: #a0aec0;
            display: inline-block;
        }

        /* Inputs */
        .input-area { display: flex; gap: 10px; margin-bottom: 15px; }
        .bulk-box { 
            flex: 1; background: var(--card); border: 1px solid #2d3748;
            border-radius: 10px; padding: 12px; color: white;
        }
        .btn { padding: 12px 20px; border-radius: 10px; border: none; font-weight: 900; cursor: pointer; }
        .btn-load { background: var(--primary); color: #000; }
        .btn-clr { background: var(--danger); color: #fff; }

        .numpad {
            display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px;
            background: var(--card); padding: 15px; border-radius: 15px;
        }
        .n-btn {
            aspect-ratio: 1; background: #2d3748; border: none; color: white;
            font-weight: bold; border-radius: 8px; cursor: pointer; font-size: 1.1rem;
        }
        .n-btn.zero { background: #2f855a; }
        .n-btn:active { background: var(--primary); color: #000; }

        .history-ribbon {
            margin-top: 20px; display: flex; flex-wrap: wrap; gap: 6px;
        }
        .h-chip { background: #2d3748; padding: 3px 9px; border-radius: 5px; font-size: 0.8rem; color: #cbd5e0; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PAIR PREDICTOR</h1>
        </header>

        <div class="prediction-card">
            <div id="status" class="status-header">Scanning History...</div>
            
            <div class="dozen-pair-display">
                <div class="dozen-box" id="box1">
                    <span class="num-val">-</span>
                    <span class="label">DOZEN A</span>
                </div>
                <div class="dozen-box" id="box2">
                    <span class="num-val">-</span>
                    <span class="label">DOZEN B</span>
                </div>
            </div>

            <div class="seq-tag">
                Sequence: <strong id="seqView" style="color: white;">---</strong>
            </div>
        </div>

        <div class="input-area">
            <input type="text" id="bulk" class="bulk-box" placeholder="12, 35, 1, 0, 22...">
            <button id="loadBtn" class="btn btn-load">LOAD</button>
            <button id="clrBtn" class="btn btn-clr">CLR</button>
        </div>

        <div class="numpad" id="numpad"></div>
        <div class="history-ribbon" id="history"></div>
    </div>

    <script>
        let history = [];

        function getDoz(n) {
            if (n === 0) return 0;
            return Math.ceil(n / 12);
        }

        function init() {
            const pad = document.getElementById('numpad');
            const z = document.createElement('button');
            z.className = 'n-btn zero'; z.textContent = '0';
            z.onclick = () => addNum(0);
            pad.appendChild(z);
            for(let i=1; i<=36; i++) {
                const b = document.createElement('button');
                b.className = 'n-btn'; b.textContent = i;
                b.onclick = () => addNum(i);
                pad.appendChild(b);
            }
        }

        function addNum(n) {
            history.push(n);
            update();
        }

        function update() {
            // UI History
            const hDiv = document.getElementById('history');
            hDiv.innerHTML = history.slice(-15).map(n => `<span class="h-chip">${n}</span>`).join('');

            if (history.length < 3) return;

            const dozHist = history.map(getDoz);
            const last3 = dozHist.slice(-3);
            document.getElementById('seqView').textContent = last3.join(' â†’ ');

            let pair = [];
            let matchFound = false;

            // Step 1: Search for the 3-dozen sequence match
            // Starting search index is current length minus 4 (the item just before the current sequence)
            for (let i = dozHist.length - 4; i >= 0; i--) {
                if (dozHist[i] === last3[0] && 
                    dozHist[i+1] === last3[1] && 
                    dozHist[i+2] === last3[2]) {
                    
                    // Step 2: Extract exactly TWO UNIQUE dozens that followed that match
                    for (let j = i + 3; j < dozHist.length - 3; j++) {
                        let dozenVal = dozHist[j];
                        
                        // Rule: Add only if it's not already in our pair (Skip repeats)
                        if (!pair.includes(dozenVal)) {
                            pair.push(dozenVal);
                        }

                        // Stop once we have exactly 2 unique dozens
                        if (pair.length === 2) {
                            matchFound = true;
                            break;
                        }
                    }
                    
                    if (matchFound) break; // Use the most recent completed pair
                }
            }

            render(matchFound, pair);
        }

        function render(isMatch, pairData) {
            const status = document.getElementById('status');
            const b1 = document.getElementById('box1');
            const b2 = document.getElementById('box2');
            
            if (isMatch) {
                status.textContent = "MATCH FOUND - BET ON PAIR";
                status.classList.add('active');
                
                b1.querySelector('.num-val').textContent = pairData[0];
                b1.classList.add('hit');
                
                b2.querySelector('.num-val').textContent = pairData[1];
                b2.classList.add('hit');
            } else {
                status.textContent = "Searching Sequence...";
                status.classList.remove('active');
                
                b1.querySelector('.num-val').textContent = "-";
                b1.classList.remove('hit');
                
                b2.querySelector('.num-val').textContent = "-";
                b2.classList.remove('hit');
            }
        }

        document.getElementById('loadBtn').onclick = () => {
            const val = document.getElementById('bulk').value;
            const nums = val.split(/[ ,]+/).map(n => parseInt(n.trim())).filter(n => !isNaN(n) && n>=0 && n<=36);
            history = [...history, ...nums];
            update();
            document.getElementById('bulk').value = '';
        };

        document.getElementById('clrBtn').onclick = () => {
            history = [];
            document.getElementById('seqView').textContent = "---";
            update();
        };

        window.onload = init;
    </script>
</body>
</html>
